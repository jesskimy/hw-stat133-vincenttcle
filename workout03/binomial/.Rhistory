main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = .5, Colv = NA, Rowv = NA)
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),]
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = .7, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = .5, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = .7, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = .7, Colv = NA, Rowv = NA)
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),]
#heatmap plotting, make sure to export it!
heatmap.2(as.matrix(sigp_rnadata_mdedvfded[,1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED", margins = c(6,6), cexRow = .5, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(7,7), cexRow = .7, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(7,7), cexRow = .9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(10,10), cexRow = .9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(1,1), cexRow = .9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(5,5), cexRow = .9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = .9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
sigp_rnadata_mdedvfded_diff
head(sigp_rnadata_mdedvfded_diff)
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = .7, Colv = NA, Rowv = NA)
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),]
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),]
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], std_diff)
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff)),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6], desc(std_diff))), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6], desc(std_diff))), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6], desc(std_diff))
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
arrange(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),], desc(std_diff))
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),]
rev(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),])
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff > 0),]
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),]
sigp_rnadata_mdedvfded_diff
head(sigp_rnadata_mdedvfded_diff)
which(sigp_rnadata_mdedvfded_diff$std_diff < 0)
which(sigp_rnadata_mdedvfded_diff$std_diff > 0)
length(which(sigp_rnadata_mdedvfded_diff$std_diff > 0))
#table for higher expression in males
sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),]
nrow(sigp_rnadata_mdedvfded_diff):length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))
_rnadata_mdedvfded_diff):length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)),]
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)))-1,]
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)))+1,]
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)))+1,1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)))+1,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0)))+1,]
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))),]
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),]
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#table for higher expression in females
sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),]
#table for higher expression in females
write.csv(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),], "../results/Female DED vs Male DED/fdedvmded_femaleexpression.csv")
#table for higher expression in males
write.csv(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),], "../results/Female DED vs Male DED/fdedvmded_maleexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6,6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[which(sigp_rnadata_mdedvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
#Data Frame setup for significant genes heatmap, separated by expression/sex
sigp_rnadata_fhvfded_diff <- rnadata_fhvfded[sigp_fhvfded[,1],]
head(sigp_rnadata_fhvfded_diff)
tail(sigp_rnadata_fhvfded_diff)
sigp_rnadata_fhvfded_diff$fmeans <- rowMeans(sigp_rnadata_fhvfded_diff[,2:4])
sigp_rnadata_fhvfded_diff$mmeans <- rowMeans((sigp_rnadata_fhvfded_diff[,5:7]))
sigp_rnadata_fhvfded_diff$dif_f_m <- sigp_rnadata_fhvfded_diff$fmeans - sigp_rnadata_fhvfded_diff$mmeans
sigp_rnadata_fhvfded_diff$total_avg <- (sigp_rnadata_fhvfded_diff$fmeans + sigp_rnadata_fhvfded_diff$mmeans)/2
sigp_rnadata_fhvfded_diff$std_diff <- sigp_rnadata_fhvfded_diff$dif_f_m / sigp_rnadata_fhvfded_diff$total_avg
sigp_rnadata_fhvfded_diff <- arrange(sigp_rnadata_fhvfded_diff, std_diff)
rownames(sigp_rnadata_fhvfded_diff) <- sigp_rnadata_fhvfded_diff[,1]
sigp_rnadata_fhvfded_diff[,1] <- NULL
head(sigp_rnadata_fhvfded_diff)
#table for higher expression in females
write.csv(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),], "../results/Female Healthy vs Female DED/fhvfded_femaleexpression.csv")
#table for higher expression in males
write.csv(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),], "../results/Female Healthy vs Female DED/fhvfded_maleexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
sigp_rnadata_fhvfded_diff <- rnadata_fhvfded[sigp_fhvfded[,1],]
rnadata_fhvfded
rnadata_fhvfded <- rnadata[, c(1,5,6,7,2,3,4)]
sigp_rnadata_fhvfded_diff <- rnadata_fhvfded[sigp_fhvfded[,1],]
head(sigp_rnadata_fhvfded_diff)
tail(sigp_rnadata_fhvfded_diff)
sigp_rnadata_fhvfded_diff$fmeans <- rowMeans(sigp_rnadata_fhvfded_diff[,2:4])
sigp_rnadata_fhvfded_diff$mmeans <- rowMeans((sigp_rnadata_fhvfded_diff[,5:7]))
sigp_rnadata_fhvfded_diff$dif_f_m <- sigp_rnadata_fhvfded_diff$fmeans - sigp_rnadata_fhvfded_diff$mmeans
sigp_rnadata_fhvfded_diff$total_avg <- (sigp_rnadata_fhvfded_diff$fmeans + sigp_rnadata_fhvfded_diff$mmeans)/2
sigp_rnadata_fhvfded_diff$std_diff <- sigp_rnadata_fhvfded_diff$dif_f_m / sigp_rnadata_fhvfded_diff$total_avg
sigp_rnadata_fhvfded_diff <- arrange(sigp_rnadata_fhvfded_diff, std_diff)
rownames(sigp_rnadata_fhvfded_diff) <- sigp_rnadata_fhvfded_diff[,1]
sigp_rnadata_fhvfded_diff[,1] <- NULL
head(sigp_rnadata_fhvfded_diff)
#table for higher expression in females
write.csv(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),], "../results/Female Healthy vs Female DED/fhvfded_femaleexpression.csv")
#table for higher expression in males
write.csv(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),], "../results/Female Healthy vs Female DED/fhvfded_maleexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \n Higher Expression in Males", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Higher Expression in Males", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
sum(fhvfded_df_ordered[,2] < 0.05)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mdedvfded_diff[nrow(sigp_rnadata_mdedvfded_diff):(length(which(sigp_rnadata_mdedvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FDED vs MDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \nHigher Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Higher Expression in Males", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Higher Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Higher Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Males", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Males", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in DED Females", margins = c(6,6), cexRow = 0.6, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in DED Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,7), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,7), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,8), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in DED Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in DED Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#table for higher expression in females
write.csv(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),], "../results/Female Healthy vs Female DED/fhvfded_healthyexpression.csv")
#table for higher expression in males
write.csv(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),], "../results/Female Healthy vs Female DED/fhvfded_dedexpression.csv")
sum(mhvmded_df_ordered[,2] < 0.05)
rnadata_mhvmded <- rnadata[,c(1,11,12,13,8,9,10)]
#Data Frame setup for significant genes heatmap, separated by expression/condition
sigp_rnadata_mhvmded_diff <- rnadata_mhvmded[sigp_mhvmded[,1],]
head(sigp_rnadata_mhvmded_diff)
tail(sigp_rnadata_mhvmded_diff)
sigp_rnadata_mhvmded_diff$fmeans <- rowMeans(sigp_rnadata_mhvmded_diff[,2:4])
sigp_rnadata_mhvmded_diff$mmeans <- rowMeans((sigp_rnadata_mhvmded_diff[,5:7]))
sigp_rnadata_mhvmded_diff$dif_f_m <- sigp_rnadata_mhvmded_diff$fmeans - sigp_rnadata_mhvmded_diff$mmeans
sigp_rnadata_mhvmded_diff$total_avg <- (sigp_rnadata_mhvmded_diff$fmeans + sigp_rnadata_mhvmded_diff$mmeans)/2
sigp_rnadata_mhvmded_diff$std_diff <- sigp_rnadata_mhvmded_diff$dif_f_m / sigp_rnadata_mhvmded_diff$total_avg
sigp_rnadata_mhvmded_diff <- arrange(sigp_rnadata_mhvmded_diff, std_diff)
rownames(sigp_rnadata_mhvmded_diff) <- sigp_rnadata_mhvmded_diff[,1]
sigp_rnadata_mhvmded_diff[,1] <- NULL
head(sigp_rnadata_mhvmded_diff)
#table for higher expression in healthy
write.csv(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),], "../results/Male Healthy vs Male DED/mhvmded_healthyexpression.csv")
#table for higher expression in ded
write.csv(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),], "../results/Male Healthy vs Male DED/mhvmded_dedexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Highest Expression in Healthy Malesales", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Highest Expression in DED Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
sigp_rnadata_fhvfded_diff <- rnadata_fhvfded[sigp_fhvfded[,1],]
head(sigp_rnadata_fhvfded_diff)
tail(sigp_rnadata_fhvfded_diff)
sigp_rnadata_fhvfded_diff$hmeans <- rowMeans(sigp_rnadata_fhvfded_diff[,2:4])
sigp_rnadata_fhvfded_diff$dedmeans <- rowMeans((sigp_rnadata_fhvfded_diff[,5:7]))
sigp_rnadata_fhvfded_diff$dif_h_ded <- sigp_rnadata_fhvfded_diff$hmeans - sigp_rnadata_fhvfded_diff$dedmeans
sigp_rnadata_fhvfded_diff$total_avg <- (sigp_rnadata_fhvfded_diff$hmeans + sigp_rnadata_fhvfded_diff$dedmeans)/2
sigp_rnadata_fhvfded_diff$std_diff <- sigp_rnadata_fhvfded_diff$dif_h_ded / sigp_rnadata_fhvfded_diff$total_avg
sigp_rnadata_fhvfded_diff <- rnadata_fhvfded[sigp_fhvfded[,1],]
head(sigp_rnadata_fhvfded_diff)
tail(sigp_rnadata_fhvfded_diff)
sigp_rnadata_fhvfded_diff$hmeans <- rowMeans(sigp_rnadata_fhvfded_diff[,2:4])
sigp_rnadata_fhvfded_diff$dedmeans <- rowMeans((sigp_rnadata_fhvfded_diff[,5:7]))
sigp_rnadata_fhvfded_diff$dif_h_ded <- sigp_rnadata_fhvfded_diff$hmeans - sigp_rnadata_fhvfded_diff$dedmeans
sigp_rnadata_fhvfded_diff$total_avg <- (sigp_rnadata_fhvfded_diff$hmeans + sigp_rnadata_fhvfded_diff$dedmeans)/2
sigp_rnadata_fhvfded_diff$std_diff <- sigp_rnadata_fhvfded_diff$dif_h_ded / sigp_rnadata_fhvfded_diff$total_avg
sigp_rnadata_fhvfded_diff <- arrange(sigp_rnadata_fhvfded_diff, std_diff)
rownames(sigp_rnadata_fhvfded_diff) <- sigp_rnadata_fhvfded_diff[,1]
sigp_rnadata_fhvfded_diff[,1] <- NULL
head(sigp_rnadata_fhvfded_diff)
#table for higher expression in healthy
write.csv(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),], "../results/Female Healthy vs Female DED/fhvfded_healthyexpression.csv")
#table for higher expression in ded
write.csv(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),], "../results/Female Healthy vs Female DED/fhvfded_dedexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in Healthy Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Highest Expression in DED Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
sigp_rnadata_mhvmded_diff <- rnadata_mhvmded[sigp_mhvmded[,1],]
head(sigp_rnadata_mhvmded_diff)
tail(sigp_rnadata_mhvmded_diff)
sigp_rnadata_mhvmded_diff$hmeans <- rowMeans(sigp_rnadata_mhvmded_diff[,2:4])
sigp_rnadata_mhvmded_diff$dedmeans <- rowMeans((sigp_rnadata_mhvmded_diff[,5:7]))
sigp_rnadata_mhvmded_diff$dif_h_ded <- sigp_rnadata_mhvmded_diff$hmeans - sigp_rnadata_mhvmded_diff$dedmeans
sigp_rnadata_mhvmded_diff$total_avg <- (sigp_rnadata_mhvmded_diff$hmeans + sigp_rnadata_mhvmded_diff$dedmeans)/2
sigp_rnadata_mhvmded_diff$std_diff <- sigp_rnadata_mhvmded_diff$dif_h_ded / sigp_rnadata_mhvmded_diff$total_avg
sigp_rnadata_mhvmded_diff <- arrange(sigp_rnadata_mhvmded_diff, std_diff)
rownames(sigp_rnadata_mhvmded_diff) <- sigp_rnadata_mhvmded_diff[,1]
sigp_rnadata_mhvmded_diff[,1] <- NULL
head(sigp_rnadata_mhvmded_diff)
#table for higher expression in healthy
write.csv(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),], "../results/Male Healthy vs Male DED/mhvmded_healthyexpression.csv")
#table for higher expression in ded
write.csv(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),], "../results/Male Healthy vs Male DED/mhvmded_dedexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Highest Expression in Healthy Malesales", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Highest Expression in DED Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Highest Expression in Healthy Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \nHighest Expression in DED Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Highest Expression in Healthy Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Highest Expression in Healthy Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[nrow(sigp_rnadata_mhvmded_diff):(length(which(sigp_rnadata_mhvmded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Expressed Genes in Healthy Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_mhvmded_diff[which(sigp_rnadata_mhvmded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: MH vs MDED \n Top 50 Expressed Genes in DED Males", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
sum(mhvmded_df_ordered[,2] < 0.05)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in healthy
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[nrow(sigp_rnadata_fhvfded_diff):(length(which(sigp_rnadata_fhvfded_diff$std_diff < 0))+1),1:6][1:50,]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Expressed Genes in Healthy Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Expressed Genes in DED Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Expressed Genes in DED Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in ded
heatmap.2(as.matrix(sigp_rnadata_fhvfded_diff[which(sigp_rnadata_fhvfded_diff$std_diff < 0),1:6][1:50,]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs FDED \n Top 50 Expressed Genes in DED Females", margins = c(6,9), cexRow = 0.9, Colv = NA, Rowv = NA)
sum(fhvfded_df_ordered[,2] < 0.05)
sum(mhvfh_df_ordered[,2] < 0.05)
sum(mdedvfded_df_ordered[,2] < 0.05)
rnadata_mhvfh <- rnadata[,c(1,5,6,7,11,12,13)]
sigp_rnadata_mhvfh_diff <- rnadata_mhvfh[sigp_mhvfh[,1],]
head(sigp_rnadata_mhvfh_diff)
tail(sigp_rnadata_mhvfh_diff)
sigp_rnadata_mhvfh_diff$fmeans <- rowMeans(sigp_rnadata_mhvfh_diff[,2:4])
sigp_rnadata_mhvfh_diff$mmeans <- rowMeans((sigp_rnadata_mhvfh_diff[,5:7]))
sigp_rnadata_mhvfh_diff$dif_f_m <- sigp_rnadata_mhvfh_diff$fmeans - sigp_rnadata_mhvfh_diff$mmeans
sigp_rnadata_mhvfh_diff$total_avg <- (sigp_rnadata_mhvfh_diff$fmeans + sigp_rnadata_mhvfh_diff$mmeans)/2
sigp_rnadata_mhvfh_diff$std_diff <- sigp_rnadata_mhvfh_diff$dif_f_m / sigp_rnadata_mhvfh_diff$total_avg
sigp_rnadata_mhvfh_diff <- arrange(sigp_rnadata_mhvfh_diff, std_diff)
rownames(sigp_rnadata_mhvfh_diff) <- sigp_rnadata_mhvfh_diff[,1]
sigp_rnadata_mhvfh_diff[,1] <- NULL
head(sigp_rnadata_mhvfh_diff)
#table for higher expression in females
write.csv(sigp_rnadata_mhvfh_diff[nrow(sigp_rnadata_mhvfh_diff):(length(which(sigp_rnadata_mhvfh_diff$std_diff < 0))+1),], "../results/Female Healthy vs Male Healthy/fhvmh_femaleexpression.csv")
#table for higher expression in males
write.csv(sigp_rnadata_mhvfh_diff[which(sigp_rnadata_mhvfh_diff$std_diff < 0),], "../results/Female Healthy vs Male Healthy/fhvmh_maleexpression.csv")
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mhvfh_diff[nrow(sigp_rnadata_mhvfh_diff):(length(which(sigp_rnadata_mhvfh_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs MH \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_mhvfh_diff[which(sigp_rnadata_mhvfh_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs MH \n Higher Expression in Males", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mhvfh_diff[nrow(sigp_rnadata_mhvfh_diff):(length(which(sigp_rnadata_mhvfh_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs MH \nHigher Expression in Females", margins = c(6,6), cexRow = 0.9, Colv = NA, Rowv = NA)
#Plotting of heatmaps separated by expression/sex
#two heatmaps
#higher expression in females
heatmap.2(as.matrix(sigp_rnadata_mhvfh_diff[nrow(sigp_rnadata_mhvfh_diff):(length(which(sigp_rnadata_mhvfh_diff$std_diff < 0))+1),1:6]
), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs MH \nHigher Expression in Females", margins = c(6,9), cexRow = 0.8, Colv = NA, Rowv = NA)
#higher expression in males
heatmap.2(as.matrix(sigp_rnadata_mhvfh_diff[which(sigp_rnadata_mhvfh_diff$std_diff < 0),1:6]), col=rev(morecols(50)), trace= "none", scale = "row",
main = "DE Genes: FH vs MH \n Higher Expression in Males", margins = c(6,6), cexRow = 1, Colv = NA, Rowv = NA)
sum(mhvfh_df_ordered[,2] < 0.05)
